---
title: "STA137-Project"
author: "Andy Kim"
date: "2026-02-25"
output: pdf_document
---

```{r}
# Reading Dataset
library(tidyverse)
library(lubridate)

# Dataset 1: cleaned_weather.csv (10-minute data)
data1 = read_csv("cleaned_weather.csv")
data1$time = ymd_hms(data1$date)         # Parse time from 'date' column
data1$T = as.numeric(data1$T)            # Ensure temperature is numeric
data1 = data1 %>% select(time, T) %>% filter(!is.na(time), !is.na(T))

# Dataset 2: Weather_Data_1980_2024(hourly).csv (hourly data)
data2 = read_csv("Weather_Data_1980_2024(hourly).csv")
data2$time = ymd_hms(data2$time)         # Parse time
data2$temp = as.numeric(data2$temperature)
data2 = data2 %>% select(time, temp) %>% filter(!is.na(time), !is.na(temp))
```

```{r}
# Aggregating to daily averages (primary seasonality now comes from annual instead of diurnal pattern)

daily1 = data1 %>%
  mutate(day = floor_date(time, "day")) %>%
  group_by(day) %>%
  summarise(T_avg = mean(T, na.rm = TRUE), .groups = "drop")

daily2 = data2 %>%
  mutate(day = floor_date(time, "day")) %>%
  group_by(day) %>%
  summarise(T_avg = mean(temp, na.rm = TRUE), .groups = "drop")

```


```{r}
# Step 3: Plot both on the same scale 

plot(daily1$day, daily1$T_avg, type = "l", col = "blue", xlab = "", ylab = "Temp (°C)",
     main = "cleaned_weather.csv (10-min -> daily avg)")
grid()

plot(daily2$day, daily2$T_avg, type = "l", col = "darkgreen", xlab = "", ylab = "Temp (°C)",
     main = "Weather_Data_1980_2024(hourly).csv (hourly -> daily avg)")
grid()
```

START OF PROJECT (USE DATA2: HOURLY DATA)

```{r}
#libraries needed
library(tidyverse)
library(lubridate)
```

```{r}

#get data
data = read_csv("Weather_Data_1980_2024(hourly).csv")
data$time = ymd_hms(data$time)      
data$temperature = as.numeric(data$temperature)            
data = data %>% select(time, temperature) %>% filter(!is.na(time), !is.na(temperature))


#aggregate daily averages to get rid of diurnal seasonality (now only yearly seasonality)
daily = data %>%
  mutate(day = floor_date(time, "day")) %>%
  group_by(day) %>%
  summarise(T_avg = mean(temperature, na.rm = TRUE), .groups = "drop")

data = ts(data, start = 1, 365)

#time series plot
plot.ts(daily$T_avg)
```
DATA ANALYSIS
```{r}
#Initial data transformation


#TODO STABILIZE VARIANCE, CLASSICAL DECOMPOSITION
#MOVING AVERAGES FILTER: 2 SIDED AND 1 SIDED

```

```{r}
#ANALYZE SMOOTHING COMPONENT
A = matrix(daily$T_avg, ncol = 365, byrow = "TRUE")

#TODO GET RID OF FEB 29 LEAP YEAR
#HW 2 QUESTION 6
```

